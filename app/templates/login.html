{% extends "base.html" %}

{% block content %}

<style>
  .login-container {
    max-width: 400px;
    margin: auto;
    padding-top: 50px;
  }

  .signup-link-container {
    margin-top: 30px;
    text-align: center;
    display: block;
  }

  .login-form {
    background: #fff;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, .05);
  }

  .login-form h1 {
    text-align: center;
    color: #333;
  }

  .login-form .form-control {
    border-radius: 20px;
    padding: 25px;
    font-size: 16px;
  }

  .login-form .form-group {
    margin-bottom: 15px;
  }

  .login-form .btn {
    width: 100%;
    border-radius: 20px;
    padding: 10px;
    font-size: 18px;
  }

  /* Adjust colors, hover effects, etc., as per the design */
  .login-form .btn-primary {
    background-color: #007bff;
    border-color: #007bff;
  }

  .sign-up-link {
    text-align: center;
    display: block;
    margin-top: 20px;
  }



  /* Ensures the border color stays consistent during focus */
  .form-control:focus {
    border-color: #80bdff;
    box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
  }

  .input-group .form-control {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
  }

  .input-group .form-control,
  .input-group .input-group-text {
    border-color: #ced4da;
    /* matching Bootstrap's default border color */
  }

  /* This will ensure that the input group's children are properly aligned */
  .input-group>.form-control,
  .input-group>.input-group-prepend>.input-group-text {
    display: flex;
    align-items: center;
    padding: 0.375rem 0.75rem;
  }

  /* Adjust the size of the icon */
  .input-group-text .fas {
    font-size: 0.9rem;
    /* you can adjust the size as needed */
  }

  .input-group-text {
    background-color: #fff;
    /* Set the background color to white */
    border-top: 1px solid #ced4da;
    border-bottom: 1px solid #ced4da;
    border-left: 1px solid #ced4da;
    border-right: none;
    /* Remove the right border to visually connect the icon */
  }

  .form-control {
    border: 1px solid #ced4da;
    /* Ensure the input has a full border */
    border-radius: 20px;
    /* Rounded corners for the input field */
    border-left: none;
    /* Remove the left border to visually connect to the icon */
  }

  /* Use this if .input-group-prepend is also being used */
  .input-group-prepend .input-group-text {
    border-right: none;
    /* Remove the right border */
  }

  .input-group-append {
    border-left: none;
    /* This ensures that no left border is applied to the append element */
  }

  /* Ensure the password field does not have a right border */
  .input-group .form-control.password {
    border-right: none !important;
  }

/* Matching the input field border styles for the button */
.toggle-password {
  border: 1px solid #ced4da; /* Match the border width and color */
  border-left: none; /* Remove the left border to make it seamless */
  border-radius: 0 20px 20px 0; /* Match the border radius (top-right and bottom-right corners) */
  outline: none; /* Removes the outline to prevent a focus ring */
  background: transparent; /* Ensures the button has no background color */
  padding: 0.375rem 0.75rem; /* Adjust padding to match the input field */
  cursor: pointer; /* Changes the mouse cursor to a pointer on hover */
}

/* Adjust the icon size and alignment if necessary */
.toggle-password .fas {
  font-size: 1rem; /* Example size, adjust as needed */
  vertical-align: middle; /* Centers the icon vertically */
}

/* When the button is clicked or focused, ensure no additional borders appear */
.toggle-password:focus, .toggle-password:active {
  box-shadow: none; /* Remove Bootstrap's default focus glow */
  position: relative; /* To prevent shifting when the border changes */
}

</style>

<div class="login-container">
  <form class="login-form" action="" method="post" novalidate>
    <h1>Login</h1>
    {{ form.hidden_tag() }}

    <div class="form-group">
      {{ form.email.label }}
      <div class="input-group">
        <div class="input-group-prepend">
          <span class="input-group-text">
            <i class="fas fa-envelope"></i>
          </span>
        </div>
        {{ form.email(class_="form-control", placeholder="Email") }}
      </div>
      {% for error in form.email.errors %}
      <span style="color: red;">[{{ error }}]</span>
      {% endfor %}
    </div>
    <div class="form-group">
      {{ form.password.label }}
      <div class="input-group">
        <div class="input-group-prepend">
          <span class="input-group-text">
            <i class="fas fa-lock"></i>
          </span>
        </div>
        {{ form.password(class_="form-control password", placeholder="Enter your password") }}
        <div class="input-group-append">
          <button class="toggle-password" type="button" onclick="togglePasswordVisibility()">
            <i class="fas fa-eye"></i>
          </button>
        </div>        
      </div>      
      {% for error in form.password.errors %}
      <span style="color: red;">[{{ error }}]</span>
      {% endfor %}
    </div>


    <p>
      {% with messages = get_flashed_messages() %}
      {% if messages %}
    <ul class="flashed-messages">
      {% for message in messages %}
      <li>{{ message }}</li>
      {% endfor %}
    </ul>
    {% endif %}
    {% endwith %}
    </p>

    {{ form.submit(class_="btn btn-primary") }}

    <div class="signup-link-container">
      Don't have an account? <a href="{{ url_for('users.register') }}">Sign up now</a>
    </div>
  </form>
</div>


<script>
  function togglePasswordVisibility() {
    var passwordInput = document.getElementById('password');
    var toggleIcon = document.querySelector('.toggle-password .fas');
    if (passwordInput.type === 'password') {
      passwordInput.type = 'text';
      toggleIcon.classList.remove('fa-eye');
      toggleIcon.classList.add('fa-eye-slash');
    } else {
      passwordInput.type = 'password';
      toggleIcon.classList.remove('fa-eye-slash');
      toggleIcon.classList.add('fa-eye');
    }
  }
  </script>
  

{% endblock %}